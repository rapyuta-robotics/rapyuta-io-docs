= Builds

An application build converts your source code into runnable rapyuta.io package artifacts. Build recipes are used to tell the build engine
how to build your source code. Builds are automatically triggered once you specify a build recipe and a source repository during package creation.

== Build recipes
A build recipe contains instructions to build applications of a particular type. For example catkin-based ROS applications, Django applications with
NGINX web server, etc. They can be used by developers to standardize the build process for applications across a team.
Build recipes allow the platform to provide tailored build environments for an application type. For example, they can make choices on build tools,
security policies, logging and monitoring tools, etc.

An application build is specified during package creation as shown in the example below:

image::executables.png["Specifying a new executable from a git repository."]

== Target platforms
We support building docker containers for the following platforms:

* x86-64
* ARMv7 (32-bit)

== Git Branches and Tags

For building from a specific tag or branch, you can use https://en.wikipedia.org/wiki/Fragment_identifier[URL fragments] in the Executables field of the package manifest.

Example:

https://github.com/rapyuta/io_tutorials.git#branch_name

or

https://github.com/rapyuta/io_tutorials.git#40faccd8b4d1e92636fa229258005caa4718c966


== Using private repositories
rapyuta.io Build Engine requires access to any Git repositories defined as source
for a Package. *Source secrets* are used to provide the Build Engine with access
to private repositories or repositories with self-signed or untrusted SSL
certificates. You can create these secrets from _Source secrets_ tab.

The following source secret types are supported. You can also use a
combination of these configurations.


* *Basic Authentication*

Basic authentication requires either a combination of username and password,
or a token to authenticate against the SCM server.

image::source_secrets_basic.png["Specifying a new source secret with basic authentication.",650]

* *SSH Key Authentication*

SSH key based authentication requires a private SSH key. Follow these tutorials
to add SSH keys for your https://help.github.com/articles/connecting-to-github-with-ssh/[GitHub] or
https://confluence.atlassian.com/bitbucket/set-up-an-ssh-key-728138079.html[Bitbucket] repository.
[NOTE]
Build engine will fail for the SSH keys with passphrase. When creating your SSH
key, leave the passphrase blank.

image::source_secrets_ssh.png["Specifying a new source secret with SSH key authentication.",650]

* *Trusted Certificate Authorities*

If your Git server uses a self-signed or untrusted certificate, you can use this
 option. Password or token fields are optional, if ca.crt is given.

image::source_secrets_ca_crt.png["Specifying a new source secret with ca.crt",650]

*Source URI patterns*

You can specify your Git server url patterns using _Source URI patterns_ field.
Build engine will match the Git source given in the Package definition to these
source URIs and will then use the containing source secret to build the package.

image::source_secrets_uri_patterns.png["URI patterns for source secrets",650]

A URI pattern must consist of:

* a valid scheme (*://, git://, http://, https:// or ssh://).

* a host (* or a valid hostname or IP address optionally preceded by *.).

* a path (/* or / followed by any characters optionally including * characters).

In all of the above, a * character is interpreted as a wildcard.

URI patterns only match Git source URIs which are conformant to RFC3986. For
example, https://github.com/rapyuta/sample.git. They do not match the
alternate SSH style that Git also uses. For example,
git@github.com:rapyuta/sample.git. It is also not valid to include a
username/password component in a URI pattern.


If multiple secrets match the Git source of a particular Package, Build Engine will
select the secret with the longest match. This allows for basic overriding. For
example, secret with source URI https://\*.rapyuta-robotics.com/* will match with any SCM
server in the domain rapyuta-robotics.com accessed over HTTPS but secret with source URI
https://ioconsole.rapyuta-robotics.com/* will override configurations for ioconsole.rapyuta-robotics.com







